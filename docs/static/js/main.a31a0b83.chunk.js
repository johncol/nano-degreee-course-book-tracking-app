(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(44)},29:function(e,t,n){},42:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(20),l=n.n(r),c=n(47),s=(n(29),n(8)),i=n(9),u=n(12),h=n(10),m=n(13),d=n(6),f=n(5),b=n(7),p=n(45),v=n(21),k=n(46),S=function(e){var t=e.children;return o.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light bg-light navigation"},t)},E=function(e){var t=e.title;return o.a.createElement(v.a,{className:"navbar-brand",to:"/"},t)},g=function(){return o.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"}))},y=function(e){return o.a.createElement(k.a,Object.assign({},e,{className:"nav-link"}))},N=function(e){var t=e.links;return o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},o.a.createElement("ul",{className:"navbar-nav"},t.map(function(e,t){return o.a.createElement("li",{className:"nav-item",key:t},e)})))},w=function(e){var t=e.title,n=e.children;return o.a.createElement(S,null,t&&o.a.createElement(E,{title:t}),o.a.createElement(g,null),o.a.createElement(N,{links:n}))},j=function(){return o.a.createElement(w,{title:"My Book Tracking App"},o.a.createElement(y,{exact:!0,to:"/shelves"},"All books"),o.a.createElement(y,{to:"/shelves/read"},"Read"),o.a.createElement(y,{to:"/shelves/want-to-read"},"Want to read"),o.a.createElement(y,{to:"/shelves/currently-reading"},"Currently reading"),o.a.createElement(y,{to:"/search-books"},"Search books"))},O=function(){return o.a.createElement("div",{className:"welcome"},o.a.createElement("section",{className:"welcome-intro"},o.a.createElement("h1",{className:"welcome-title"},"Welcome to your book tracking app"),o.a.createElement("p",{className:"welcome-lead"},"The only one you'll ever want to use again")))},B=function(e){var t=e.dropdownId,n=e.className,a=e.label,r=e.selected,l=e.selectedOptionProp,c=e.optionsLabelProp,s=e.items,i=e.onItemSelected,u="dropdownMenuButton-"+t;return o.a.createElement("div",{className:"dropdown "+n},o.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:u,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},a),o.a.createElement("div",{className:"dropdown-menu","aria-labelledby":u},s.map(function(e){return o.a.createElement("button",{key:e.id,type:"button",className:"dropdown-item"+(e[l]===r?" selected-item":""),onClick:function(){return i(e)}},e[c])})))},I=[{id:"wantToRead",name:"Want to read",path:"want-to-read"},{id:"currentlyReading",name:"Currently reading",path:"currently-reading"},{id:"read",name:"Read",path:"read"}],T={};I.forEach(function(e){return T[e.id]=e.name});var q=I,A=function(e){var t,n=e.book,a=e.onSetBookShelf;return o.a.createElement(B,{className:"book-menu",dropdownId:n.id,label:(t=n.shelf,T[t]||"add to"),selected:n.shelf,selectedOptionProp:"id",optionsLabelProp:"name",items:q,onItemSelected:a})},C=function(e){return e.imageLinks&&e.imageLinks.smallThumbnail?e.imageLinks.smallThumbnail:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFNL0hmpLOezaeiXdKjFLz4GpXndktadW31NAueLyXbkzZK9RSig"},x=function(e){var t=e.book,n=e.onSetBookShelf;return o.a.createElement("section",{className:"card book"},o.a.createElement("div",{className:"book-cover",alt:t.title,style:{backgroundImage:"url(".concat(C(t),")")}}),o.a.createElement("h5",{className:"book-title"},t.title),t.authors&&o.a.createElement("h3",{className:"book-authors"},o.a.createElement("span",null,"by"),o.a.createElement("br",null),t.authors.map(function(e,n){return o.a.createElement("span",{key:e,className:"book-author"},e,n<t.authors.length-1?", ":"")})),o.a.createElement(A,{book:t,onSetBookShelf:function(e){return n(t,e)}}))},L=function(e,t){return e.title>t.title?1:-1},R=function(e){var t=e.books,n=e.onSetBookShelf;return o.a.createElement("div",{className:"shelf"},o.a.createElement("p",{className:"lead"},o.a.createElement("span",null,"Displaying ",t.length," book",1!==t.length?"s":"")),o.a.createElement("div",{className:"shelf-books"},t.sort(L).map(function(e){return o.a.createElement(x,{book:e,key:e.id,onSetBookShelf:n})})))},P=function(e){var t=e.booksInShelves,n=e.onSetBookShelf;return o.a.createElement("div",null,o.a.createElement(p.a,{exact:!0,path:"/shelves",render:function(){return o.a.createElement(R,{books:t.all,onSetBookShelf:n})}}),q.map(function(e){return o.a.createElement(p.a,{key:e.id,path:"/shelves/"+e.path,render:function(){return o.a.createElement(R,{books:t[e.id],onSetBookShelf:n})}})}))},W=n(23),J=n.n(W),z=function(e){var t=e.children;return o.a.createElement("div",{className:"notification alert alert-info",role:"alert"},t)},M=function(){return o.a.createElement("div",{className:"lds-dual-ring"})},Q="https://reactnd-books-api.udacity.com",U=localStorage.token;U||(U=localStorage.token=Math.random().toString(36).substr(-8));var X={Accept:"application/json",Authorization:U},D=function(e,t){return fetch("".concat(Q,"/books/").concat(e.id),{method:"PUT",headers:Object(f.a)({},X,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},F=function(e){return fetch("".concat(Q,"/search"),{method:"POST",headers:Object(f.a)({},X,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books.error?[]:e.books})},G=function(e){var t=e.query,n=e.onUpdateQuery;return o.a.createElement("div",{className:"search-bar"},o.a.createElement("input",{type:"search",className:"form-control",id:"search-input",placeholder:"Search books by name",value:t,onChange:n,autoComplete:"off"}))},K=function(e){var t=e.books,n=e.onSetBookShelf,a=e.query,r=e.loading,l=a&&""!==a.trim();return o.a.createElement("div",{className:"shelf"},o.a.createElement("p",{className:"lead"},r&&o.a.createElement("span",null,"Searching.."),!r&&!l&&o.a.createElement("span",null,"Type something to search for"),!r&&l&&o.a.createElement("span",null,0===t.length&&o.a.createElement("span",null,"No books were found"),t.length>0&&o.a.createElement("span",null,t.length," book",1!==t.length?"s were":" was"," found"))),o.a.createElement("div",{className:"shelf-books"},t.sort(L).map(function(e){return o.a.createElement(x,{book:e,key:e.id,onSetBookShelf:n})})))},Z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={results:[],query:"",queryToTriggerSearch:"",showNotification:!1,loading:!1},n.setShelvesToResults=function(e){return e.map(function(e){var t=n.props.booksInShelves.filter(function(t){return t.id===e.id});return 1===t.length&&(e.shelf=t[0].shelf),e})},n.callSearchApi=function(e){F(e).then(function(e){n.setState({results:n.setShelvesToResults(e)})}).finally(function(){return n.setState({loading:!1})})},n.search=J()(function(e){""!==e?(n.setState({loading:!0,queryToTriggerSearch:e}),n.callSearchApi(e)):n.setState({results:[]})},500),n.updateQuery=function(e){var t=e.target.value;n.setState(function(){return{query:t}},function(){return n.search(t.trim())})},n.setBookShelfAndNotify=function(e,t){n.setState({showNotification:!0}),setTimeout(function(){return n.setState({showNotification:!1})},1500),n.props.onSetBookShelf(e,t)},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.results,n=e.query,a=e.queryToTriggerSearch,r=e.showNotification,l=e.loading;return o.a.createElement("div",{className:"search-books"},r&&o.a.createElement(z,null,"Book added to shelf"),o.a.createElement(G,{query:n,onUpdateQuery:this.updateQuery}),l&&o.a.createElement(M,null),o.a.createElement(K,{loading:l,query:a,books:t,shelf:{name:"search"},onSetBookShelf:this.setBookShelfAndNotify}))}}]),t}(o.a.Component),$=(n(42),function(e,t,n){n.shelf=t;var a=[].concat(Object(b.a)(e.booksInShelves[t]),[n]),o=[].concat(Object(b.a)(e.booksInShelves.all),[n]);return{booksInShelves:Object(f.a)({},e.booksInShelves,Object(d.a)({all:o},t,a))}}),H=function(e,t,n,a){var o,r=Object(f.a)({},a,{shelf:n}),l=function(e){return e.id!==a.id},c=e.booksInShelves[t].filter(l),s=[].concat(Object(b.a)(e.booksInShelves[n]),[r]),i=[].concat(Object(b.a)(e.booksInShelves.all.filter(l)),[r]);return{booksInShelves:Object(f.a)({},e.booksInShelves,(o={all:i},Object(d.a)(o,t,c),Object(d.a)(o,n,s),o))}},V=function(e,t){var n={all:[]};return Object.keys(e).forEach(function(a){var o,r=function(e,t){return-1!==e.indexOf(t.id)}.bind(null,e[a]),l=t.filter(r);n[a]=l,(o=n.all).push.apply(o,Object(b.a)(l))}),n},Y=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={booksInShelves:{currentlyReading:[],wantToRead:[],read:[],all:[]}},n.setBookShelf=function(e,t){var a=e.shelf,o=t.id;if(a===o)return null;D(e,o).then(function(){var t=!!a;n.setState(function(n){return t?H(n,a,o,e):$(n,o,e)})})},n.updateBooksInShelvesState=function(e){var t=e[0],a=e[1],o=V(t,a);n.setState({booksInShelves:o})},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=fetch("".concat(Q,"/books/non-existing-book-id"),{method:"PUT",headers:Object(f.a)({},X,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:"none"})}).then(function(e){return e.json()}),t=fetch("".concat(Q,"/books"),{headers:X}).then(function(e){return e.json()}).then(function(e){return e.books});Promise.all([e,t]).then(this.updateBooksInShelvesState)}},{key:"render",value:function(){var e=this,t=this.state.booksInShelves;return o.a.createElement("div",null,o.a.createElement(j,null),o.a.createElement("div",{className:"content"},o.a.createElement(p.a,{exact:!0,path:"/",component:O}),o.a.createElement(p.a,{path:"/shelves",render:function(){return o.a.createElement(P,{booksInShelves:t,onSetBookShelf:e.setBookShelf})}}),o.a.createElement(p.a,{path:"/search-books",render:function(){return o.a.createElement(Z,{onSetBookShelf:e.setBookShelf,booksInShelves:t.all})}})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(c.a,null,o.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,2,1]]]);
//# sourceMappingURL=main.a31a0b83.chunk.js.map